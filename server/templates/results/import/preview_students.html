{% extends "base.html" %}

{% block title %}Preview Students Import - Result Portal{% endblock %}

{% block content %}
<div style="max-width: 1200px; margin: 40px auto; padding: 20px;">
  <h1>Preview Students Import</h1>
  <p>Review the validation results below before submitting the import.</p>

  <div style="margin: 30px 0; padding: 20px; background: #f8f9fa; border-radius: 4px;">
    <h3>Import Summary</h3>
    <p><strong>Year/Class:</strong> {{ year_class.label }}</p>
    <p><strong>Rows processed:</strong> {{ batch.row_count }}</p>
    <p><strong>Rows to create:</strong> {{ batch.created_rows }}</p>
    <p><strong>Rows to update:</strong> {{ batch.updated_rows }}</p>
    <p><strong>Rows to skip:</strong> {{ batch.skipped_rows }}</p>
  </div>

  {% if errors %}
  <div style="margin: 30px 0; padding: 20px; background: #f8d7da; border: 1px solid #f5c6cb; border-radius: 4px;">
    <h3 style="color: #721c24;">Errors</h3>
    <ul style="color: #721c24;">
      {% for error in errors %}
        <li>{{ error }}</li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}

  {% if warnings %}
  <div style="margin: 30px 0; padding: 20px; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px;">
    <h3 style="color: #856404;">Warnings</h3>
    <ul style="color: #856404;">
      {% for warning in warnings %}
        <li>{{ warning }}</li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}

  {% if not errors %}
  <form method="post" style="margin-top: 30px;">
    {% csrf_token %}
    <button type="submit" style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 500;">
      Submit for Import
    </button>
    <a href="{% url 'results:student_csv_upload' %}" style="margin-left: 10px; padding: 10px 20px; background: #6c757d; color: white; text-decoration: none; border-radius: 4px; display: inline-block;">
      Cancel
    </a>
  </form>
  {% else %}
  <div style="margin-top: 30px;">
    <p style="color: #721c24; font-weight: 500;">Please fix the errors above before submitting.</p>
    <a href="{% url 'results:student_csv_upload' %}" style="margin-top: 10px; padding: 10px 20px; background: #007bff; color: white; text-decoration: none; border-radius: 4px; display: inline-block;">
      Back to Upload
    </a>
  </div>
  {% endif %}
</div>
{% endblock %}
